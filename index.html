<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Block Games</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  background: #0a2a4a;
  color: white;
  font-family: sans-serif;
  text-align: center;
}
#logo {
  font-size: 28px;
  padding: 15px;
  user-select: none;
}
canvas {
  background: #123;
  display: block;
  margin: auto;
}
#secret {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  display: none;
}
#terminal {
  background: #111;
  border: 2px solid #0f0;
  width: 85%;
  max-width: 400px;
  margin: 80px auto;
  padding: 15px;
}
input, button {
  width: 100%;
  margin-top: 10px;
  padding: 8px;
}
</style>
</head>

<body>

<div id="logo">BLOCK GAMES</div>
<canvas id="game" width="360" height="480"></canvas>

<!-- 隠し検索画面 -->
<div id="secret">
  <div id="terminal">
    <h3>TEMPORARY TERMINAL</h3>
    <input id="q" placeholder="検索ワード">
    <button onclick="search()">検索</button>
    <pre id="result"></pre>
    <button onclick="closeSecret()">戻る</button>
  </div>
</div>

<script>
// ===== ロゴ5回タップで隠し機能 =====
const logo = document.getElementById("logo");
let tapCount = 0;
let tapTimer = null;

logo.addEventListener("click", () => {
  tapCount++;

  if (tapCount === 1) {
    tapTimer = setTimeout(() => {
      tapCount = 0;
    }, 2000);
  }

  if (tapCount === 5) {
    clearTimeout(tapTimer);
    openSecret();
    tapCount = 0;
  }
});
});

// ===== ブロック崩し =====
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let x = 180, y = 300;
let dx = 2, dy = -2;
let paddleX = 140;

const bricks = [];
for (let r = 0; r < 5; r++) {
  bricks[r] = [];
  for (let c = 0; c < 7; c++) {
    bricks[r][c] = true;
  }
}

canvas.addEventListener("touchmove", e => {
  const rect = canvas.getBoundingClientRect();
  paddleX = e.touches[0].clientX - rect.left - 40;
});

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // ボール
  ctx.beginPath();
  ctx.arc(x, y, 7, 0, Math.PI * 2);
  ctx.fillStyle = "orange";
  ctx.fill();
  ctx.closePath();

  // パドル
  ctx.fillStyle = "#f44";
  ctx.fillRect(paddleX, 450, 80, 10);

  // ブロック
  for (let r = 0; r < 5; r++) {
    for (let c = 0; c < 7; c++) {
      if (bricks[r][c]) {
        ctx.fillStyle = `hsl(${r*60},80%,60%)`;
        ctx.fillRect(c*50+5, r*22+5, 45, 16);
        if (
          x > c*50 && x < c*50+50 &&
          y > r*22 && y < r*22+22
        ) {
          dy = -dy;
          bricks[r][c] = false;
        }
      }
    }
  }

  if (x < 7 || x > canvas.width-7) dx = -dx;
  if (y < 7) dy = -dy;

  if (y > 440 && x > paddleX && x < paddleX + 80) {
    dy = -dy;
  }

  x += dx;
  y += dy;

  requestAnimationFrame(draw);
}
draw();
</script>

</body>
</html>
