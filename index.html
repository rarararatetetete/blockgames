<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>BLOCK GAMES</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #0b132b; /* 紺色 */
  color: white;
  text-align: center;
  font-family: sans-serif;
}

#logo {
  font-size: 28px;
  font-weight: bold;
  padding: 16px;
  user-select: none;
}

canvas {
  background: black;
  display: block;
  margin: 0 auto;
}

/* 隠し検索 */
#secret {
  display: none;
  background: #111;
  padding: 12px;
}

input {
  width: 90%;
  padding: 10px;
  font-size: 16px;
  margin-bottom: 8px;
}

iframe {
  width: 100%;
  height: 60vh;
  border: none;
  background: white;
}
</style>
</head>

<body>

<div id="logo">BLOCK GAMES</div>

<canvas id="game" width="360" height="480"></canvas>

<div id="secret">
  <input id="q" placeholder="検索">
  <iframe id="result"></iframe>
</div>

<script>
/* ===== ブロックゲーム ===== */
const c = document.getElementById("game");
const ctx = c.getContext("2d");

let ball = { x: 180, y: 300, dx: 4, dy: -4, r: 7 };
let paddle = { x: 140, w: 80 };
let blocks = [];

for (let y = 0; y < 4; y++) {
  for (let x = 0; x < 6; x++) {
    blocks.push({ x: x * 55 + 10, y: y * 25 + 40, alive: true });
  }
}

c.addEventListener("touchmove", e => {
  const rect = c.getBoundingClientRect();
  paddle.x = e.touches[0].clientX - rect.left - paddle.w / 2;
});

function loop() {
  ctx.clearRect(0,0,c.width,c.height);

  // ball
  ball.x += ball.dx;
  ball.y += ball.dy;

  if (ball.x < ball.r || ball.x > c.width - ball.r) ball.dx *= -1;
  if (ball.y < ball.r) ball.dy *= -1;

  if (
    ball.y > c.height - 25 &&
    ball.x > paddle.x &&
    ball.x < paddle.x + paddle.w
  ) {
    ball.dy *= -1;
  }

  blocks.forEach(b => {
    if (
      b.alive &&
      ball.x > b.x &&
      ball.x < b.x + 45 &&
      ball.y > b.y &&
      ball.y < b.y + 18
    ) {
      b.alive = false;
      ball.dy *= -1;
    }
  });

  // draw
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
  ctx.fill();

  ctx.fillRect(paddle.x, c.height - 15, paddle.w, 8);

  ctx.fillStyle = "#4da6ff";
  blocks.forEach(b => {
    if (b.alive) ctx.fillRect(b.x, b.y, 45, 18);
  });

  requestAnimationFrame(loop);
}
loop();

/* ===== 隠し機能：ロゴ5回タップ ===== */
const logo = document.getElementById("logo");
const secret = document.getElementById("secret");

let taps = 0;
let timer = null;

logo.addEventListener("touchstart", () => {
  taps++;

  if (!timer) {
    timer = setTimeout(() => {
      taps = 0;
      timer = null;
    }, 1500);
  }

  if (taps === 5) {
    secret.style.display = "block";
    taps = 0;
    clearTimeout(timer);
    timer = null;
  }
});

/* ===== 一時検索（Startpage・履歴なし）===== */
document.getElementById("q").addEventListener("keydown", e => {
  if (e.key === "Enter") {
    document.getElementById("result").src =
      "https://duckduckgo.com/?t=h_&ia=web&q=" +
      encodeURIComponent(e.target.value);
  }
});
</script>

</body>
</html>
